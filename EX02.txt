CREATE DATABASE EJERCICIO_2;
USE EJERCICIO_2;
GO
CREATE TABLE Editorial (
	ClaveEditorial SMALLINT PRIMARY KEY IDENTITY(1,1),
	Nombre VARCHAR(40),
	Direccion VARCHAR(60),
	Telefono VARCHAR(15)
)
CREATE TABLE Libro (
	ClaveLibro INT PRIMARY KEY IDENTITY(1,1),
	Titulo VARCHAR(60),
	Idioma VARCHAR(15),
	Formato VARCHAR(15),
	ClaveEditorial SMALLINT FOREIGN KEY REFERENCES Editorial(ClaveEditorial) ON DELETE SET NULL ON UPDATE CASCADE
	)
CREATE TABLE Tema (
	ClaveTema SMALLINT PRIMARY KEY IDENTITY(1,1),
	Nombre VARCHAR(40)
	)
CREATE TABLE Autor (
	ClaveAutor INT PRIMARY KEY IDENTITY(1,1),
	Nombre VARCHAR(40)
)
CREATE TABLE Ejemplar (
	ClaveEjemplar INT PRIMARY KEY IDENTITY(1,1),
	ClaveLibro INT FOREIGN KEY REFERENCES Libro(ClaveLibro) ON DELETE SET NULL ON UPDATE CASCADE,
	NumeroOrden SMALLINT,
	Edicion SMALLINT,
	Ubicacion VARCHAR(15),
	Categoria CHAR
)
CREATE TABLE Socio (
	ClaveSocio INT  PRIMARY KEY IDENTITY(1,1),
	Nombre VARCHAR(60),
	Direccion VARCHAR(60),
	Telefono VARCHAR(15),
	Categoria CHAR
)
CREATE TABLE Prestamo (
	ClaveSocio INT FOREIGN KEY REFERENCES Socio(ClaveSocio) ON DELETE SET NULL ON UPDATE CASCADE,
	ClaveEjemplar INT FOREIGN KEY REFERENCES Ejemplar(ClaveEjemplar) ON DELETE SET NULL ON UPDATE CASCADE,
	NumeroOrden SMALLINT,
	Fecha_prestamo DATE,
	Fecha_devolucion DATE,
	Notas TEXT
)
CREATE TABLE Trata_sobre (
	ClaveLibro INT FOREIGN KEY REFERENCES Libro(ClaveLibro) ON DELETE SET NULL ON UPDATE CASCADE,
	ClaveTema SMALLINT FOREIGN KEY REFERENCES Tema(ClaveTema) ON DELETE SET NULL ON UPDATE CASCADE,
)
CREATE TABLE Escrito_por(
	ClaveLibro INT FOREIGN KEY REFERENCES Libro(ClaveLibro) ON DELETE SET NULL ON UPDATE CASCADE,
	ClaveAutor INT FOREIGN KEY REFERENCES Autor(ClaveAutor) ON DELETE SET NULL ON UPDATE CASCADE,
)